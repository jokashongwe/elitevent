{% extends 'base_dashboard.html' %}

{% block header_title %}Configuration : {{ event.title }}{% endblock %}

{% block content %}

<div class="max-w-4xl mx-auto space-y-6">
    
    <div class="border-b border-gray-200">
        <nav class="-mb-px flex space-x-8">
            <a href="{% url 'manage_event' event.id %}" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                Invit√©s
            </a>
            <a href="#" class="border-indigo-500 text-indigo-600 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                Param√®tres & Boissons
            </a>
        </nav>
    </div>

    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}

        <div class="bg-white shadow px-4 py-5 sm:rounded-lg sm:p-6 mb-6">
            <div class="md:grid md:grid-cols-3 md:gap-6">
                <div class="md:col-span-1">
                    <h3 class="text-lg font-medium leading-6 text-gray-900">Informations G√©n√©rales</h3>
                    <p class="mt-1 text-sm text-gray-500">Modifiez le titre, la date ou le th√®me de votre invitation.</p>
                </div>
                <div class="mt-5 md:mt-0 md:col-span-2 space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Titre</label>
                        {{ form.title }}
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                         <div>
                            <label class="block text-sm font-medium text-gray-700">Date</label>
                            {{ form.date }}
                        </div>
                         <div>
                            <label class="block text-sm font-medium text-gray-700">Lieu</label>
                            {{ form.location }}
                        </div>
                    </div>
                    <div>
                         <label class="block text-sm font-medium text-gray-700">Th√®me Visuel</label>
                         {{ form.theme_template }}
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Image de couverture</label>
                        {{ form.cover_image }}
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white shadow px-4 py-5 sm:rounded-lg sm:p-6">
            <div class="md:grid md:grid-cols-3 md:gap-6">
                <div class="md:col-span-1">
                    <h3 class="text-lg font-medium leading-6 text-gray-900">Menu des Boissons</h3>
                    <p class="mt-1 text-sm text-gray-500">
                        Ajoutez les choix propos√©s aux invit√©s.<br>
                        <span class="text-xs italic">Cochez la case "Supprimer" et sauvegardez pour retirer une option.</span>
                    </p>
                </div>
                
                <div class="mt-5 md:mt-0 md:col-span-2">
                    
                    {{ formset.management_form }}
                    
                    <div class="space-y-4">
                        {% for drink_form in formset %}
                            <div class="border border-gray-200 rounded-md p-4 bg-gray-50 relative flex items-start gap-4">
                                
                                {% for hidden in drink_form.hidden_fields %}
                                    {{ hidden }}
                                {% endfor %}

                                <div class="flex-grow grid grid-cols-1 sm:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-500 uppercase">Nom de la boisson</label>
                                        {{ drink_form.name }}
                                        {% if drink_form.name.errors %}
                                            <div class="text-red-500 text-xs">{{ drink_form.name.errors }}</div>
                                        {% endif %}
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-500 uppercase">Description (Optionnel)</label>
                                        {{ drink_form.description }}
                                    </div>
                                </div>

                                {% if formset.can_delete and drink_form.instance.pk %}
                                    <div class="flex flex-col items-center justify-center pt-5">
                                        <label class="text-xs text-red-500 font-bold mb-1">Suppr.</label>
                                        {{ drink_form.DELETE }} </div>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>
                    
                    <div class="mt-4 p-3 bg-blue-50 text-blue-700 text-sm rounded border border-blue-100">
                        üí° Astuce : Sauvegardez pour valider les ajouts. Une nouvelle ligne vide appara√Ætra automatiquement apr√®s chaque sauvegarde.
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-6 flex justify-end">
            <a href="{% url 'dashboard_home' %}" class="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 mr-3">
                Retour
            </a>
            <button type="submit" class="bg-indigo-600 border border-transparent rounded-md shadow-sm py-2 px-4 inline-flex justify-center text-sm font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                Enregistrer les modifications
            </button>
        </div>

    </form>
</div>

{% endblock %}